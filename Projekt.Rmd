---
title: "Immigration Project"
output: html_document
date: "2025-10-06"
---

```{r}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)   
```

## Data

```{r}
# Load ESS data
dat <- read_csv("ESS7e02_3.csv")

# Select and recode relevant variables
dat2 <- dat %>%
  select(cntbrthc, fbrncntb, mbrncntb, cntry, brncntr,
         trstlgl, trstplc, trstplt, trstprl, trstprt,
         dscrgrp, hinctnta, gndr, eduyrs, agea, yrbrn) %>%
  mutate(
    migrant_gen = case_when(
      brncntr == 2 ~ "First generation", 
      brncntr == 1 & (fbrncntb != cntbrthc | mbrncntb != cntbrthc) ~ "Second generation",
      brncntr == 1 & fbrncntb == cntbrthc & mbrncntb == cntbrthc ~ "No migration background",
      TRUE ~ NA_character_
    ),
    migrant_gen = factor(migrant_gen,
                         levels = c("No migration background",
                                    "Second generation",
                                    "First generation")),
    # Binary discrimination variable
    discrim = if_else(dscrgrp == 1, 1, 0),
    gender = if_else(gndr == 1, "Male", "Female")
  )
```

```{r}
# Recoding variables, getting rid of missing values and looking at outliers
# fyi cntry has no missings hence it was not recoded

# Recode variables with 66 missing value, 77 refusal, 88 don't know, 99 no answer
dat2$cntbrthc[dat2$cntbrthc %in% c(66, 77, 88, 99)] <- NA 
dat2$fbrncntb[dat2$fbrncntb %in% c(66, 77, 88, 99)] <- NA # gibt noch 65	Alien's passport
dat2$mbrncntb[dat2$mbrncntb %in% c(66, 77, 88, 99)] <- NA # ebd.

# Recode variables: 77 refusal, 88 don't know, 99 no answer
dat2$trstlgl[dat2$trstlgl %in% c(77, 88, 99)] <- NA
dat2$trstplc[dat2$trstplc %in% c(77, 88, 99)] <- NA
dat2$trstplt[dat2$trstplt %in% c(77, 88, 99)] <- NA
dat2$trstprl[dat2$trstprl %in% c(77, 88, 99)] <- NA
dat2$trstprt[dat2$trstprt %in% c(77, 88, 99)] <- NA
dat2$hinctnta[dat2$hinctnta %in% c(77, 88, 99)] <- NA
dat2$eduyrs[dat2$eduyrs %in% c(77, 88, 99)] <-  NA
dat2$yrbrn[dat$yrbrn %in% c(7777, 8888, 9999)] <- NA

# Recode variables: 7 refusal, 8 don't know, 9 no answer
dat2$brncntr[dat2$yrbrn %in% c(7, 8, 9)] <- NA
dat2$dscrgrp[dat2$dscrgrp %in% c(7, 8, 9)] <- NA
dat2$gndr[dat2$gndr %in% c(9)] <- NA
dat2$agea[dat2$agea %in% c(999)] <- NA

# Outlier for variable eduyrs, yrbrn and agea
table(dat2$eduyrs)
median(dat2$eduyrs, na.rm = TRUE) # 12
mean(dat2$eduyrs, na.rm = TRUE) # 12.9 <- Es gibt hier 29 Fälle mit Angabe > 30 Jahre, 2 mal 50 Jahre. Letztere Rausnehmen?
mean(dat2$yrbrn, na.rm = TRUE) # 1965
table(dat2$yrbrn, useNA = 'always') # <- Gibt 24 Fälle vor 1920 irgendwie sus, wie wollen wir damit umgehen?
table(dat2$agea)
median(dat2$agea, na.rm = TRUE) # 49
mean(dat2$agea, na.rm = TRUE) # 49.28 

# Check if recoding the variables worked
table(dat2$fbrncntb, useNA = 'always')
table(dat2$mbrncntb, useNA = 'always')
table(dat2$trstlgl, useNA = 'always')
table(dat2$trstplc, useNA = 'always')
table(dat2$trstplt, useNA = 'always')
table(dat2$trstprl, useNA = 'always')
table(dat2$trstprt, useNA = 'always')
table(dat2$hinctnta, useNA = 'always')
table(dat2$eduyrs, useNA = 'always')
table(dat2$yrbrn, useNA = 'always')
table(dat2$dscrgrp, useNA = 'always')
table(dat2$gndr, useNA = 'always')
table(dat2$agea, useNA = 'always')
```

```{r}
# Creating two trust indexes :: political institutional trust and non-political institutional trust

# political institutional trust index (mean of trust items)
dat2 <- dat2 %>%
  mutate(political_trust_index = round(rowMeans(select(., "trstplt", "trstprl", "trstprt"), na.rm = TRUE)))
dat2$political_trust_index[dat2$political_trust_index == "NaN"] <- NA
table(dat2$political_trust_index, useNA = 'always')

# evtl. noch spannend aus welchen Ländern?

# non political institutional trust index (mean of trust items)
dat2 <- dat2 %>%
  mutate(non_political_trust_index = round(rowMeans(select(., "trstlgl", "trstplc"), na.rm = TRUE)))
dat2$non_political_trust_index[dat2$non_political_trust_index == "NaN"] <- NA
table(dat2$non_political_trust_index, useNA = 'always')

# distribution check
summary(dat2$political_trust_index) # median 4, mean 3.875, neutral, wenn überhaupt dann leicht rechtssteil/ linksschief
summary(dat2$non_political_trust_index) # median 6, mean 5.796, ebd.

```

## Descriptive Statistic

```{r}
dat2 %>%
  group_by(migrant_gen) %>%
  summarise(
    mean_political_trust = mean(political_trust_index, na.rm = TRUE),
    mean_nonpolitical_trust = mean(non_political_trust_index, na.rm = TRUE),
    n = n()
  )
```

## H1

```{r}
# Political trust
h1_political <- lm(political_trust_index ~ migrant_gen + agea + eduyrs + hinctnta + gender,
                   data = dat2)
summary(h1_political)

# Non-political trust
h1_nonpolitical <- lm(non_political_trust_index ~ migrant_gen + agea + eduyrs + hinctnta + gender,
                      data = dat2)
summary(h1_nonpolitical)
```

## The trust gap between first- and second-generation immigrants varies systematically by region of origin, with the largest differences among immigrants from countries with weaker institutional performance.

## H2 Political

```{r}

#dat2 <- dat2 %>%
 # mutate(region_origin = case_when(
  #  cntbrthc %in% c("TUR", "SYR", "IRQ") ~ "Non-EU (weak #institutions)",
#    cntbrthc %in% c("ITA", "ESP", "POL") ~ "EU (mixed #institutions)",
#    TRUE ~ "Other"
#  ))

# Political trust
h2_political <- lm(political_trust_index ~ migrant_gen * cntbrthc + agea + eduyrs + hinctnta, data = dat2)
summary(h2_political)
```

## H2 Non-political

```{r}
# Non-political trust
h2_nonpolitical <- lm(non_political_trust_index ~ migrant_gen * rcntbrthc + agea + eduyrs + hinctnta,
                      data = dat2)
summary(h2_nonpolitical)

```

## H3: The negative association between experiences of discrimination and institutional trust differs across different immigrant groups.

## H3 Political

```{r}

# Political trust
h3_political <- lm(political_trust_index ~ migrant_gen * discrim + agea + eduyrs + hinctnta,
                   data = dat2)
summary(h3_political)
```

A linear regression model was estimated to examine the relationship between political trust and respondents’ migrant background, experiences of discrimination, and several control variables (age, education, and income). The model included an interaction term between migration generation and perceived discrimination to explore whether the effect of discrimination on political trust differs across groups.

The results show that, on average, first-generation migrants reported significantly higher political trust compared to natives, while second-generation migrants did not differ significantly. Experiencing discrimination was associated with a significant decrease in political trust. The interaction between being a second-generation migrant and discrimination was positive and significant, suggesting that the negative effect of discrimination on trust is somewhat weaker among second-generation migrants compared to natives. Age had a small negative effect on political trust, and higher income was associated with slightly higher levels of trust. Education was not a significant predictor.

Although the model explains a modest portion of the variation in political trust (adjusted R² = 0.018), the results indicate that both migration background and perceived discrimination play a role in shaping individuals’ trust in political institutions.

## H3 Non-political

```{r}
# Non-political trust
h3_nonpolitical <- lm(non_political_trust_index ~ migrant_gen * discrim + agea + eduyrs + hinctnta,
                      data = dat2)
summary(h3_nonpolitical)

```

A second linear regression model was estimated to assess how migrant background and perceived discrimination relate to non-political trust, controlling for age, education, and income. Similar to the political trust model, interaction terms between migration generation and discrimination were included to test whether discrimination influences different groups differently.

The findings show that first-generation migrants report significantly higher non-political trust compared to natives, while the difference for second-generation migrants is not statistically significant. Perceived discrimination is strongly and negatively associated with non-political trust, indicating that those who experience discrimination tend to have lower trust in non-political institutions and people. The interaction effects between migration generation and discrimination were not significant, suggesting that the negative impact of discrimination on non-political trust is consistent across groups. Among the control variables, age, education, and income all have small but significant positive effects, meaning that older, more educated, and higher-income individuals tend to express slightly higher levels of non-political trust.

Overall, while the model explains only a small proportion of the variance in non-political trust (adjusted R² = 0.010), it indicates that discrimination plays an important role in shaping interpersonal and social trust, regardless of migration background.

## Visualization

## Trust by Migration Generation

```{r}
dat2_long <- dat2 %>%
  pivot_longer(cols = c(political_trust_index, non_political_trust_index),
               names_to = "trust_type",
               values_to = "trust_value") %>%
  mutate(trust_type = recode(trust_type,
                             political_trust_index = "Political Trust",
                             non_political_trust_index = "Non-Political Trust"))

ggplot(dat2_long, aes(x = migrant_gen, y = trust_value, fill = trust_type)) +
  geom_boxplot() +
  labs(title = "Trust in Institutions by Migration Generation",
       x = "Migration Generation", y = "Trust Index (0–10)") +
  theme_minimal()

```

## Trust Gap by Region of Origin

```{r}
dat2_long %>%
  group_by(migrant_gen, region_origin, trust_type) %>%
  summarise(mean_trust = mean(trust_value, na.rm = TRUE)) %>%
  ggplot(aes(x = migrant_gen, y = mean_trust, fill = region_origin)) +
  geom_col(position = "dodge") +
  facet_wrap(~ trust_type) +
  labs(title = "Trust in Institutions by Migration Generation and Region of Origin",
       x = "Migration Generation", y = "Mean Trust Index") +
  theme_minimal()

```

## Discrimination and Trust

```{r}
dat2_long %>%
  group_by(migrant_gen, discrim, trust_type) %>%
  summarise(mean_trust = mean(trust_value, na.rm = TRUE)) %>%
  ggplot(aes(x = factor(discrim, labels = c("No Discrimination", "Discriminated")),
             y = mean_trust, fill = migrant_gen)) +
  geom_col(position = "dodge") +
  facet_wrap(~ trust_type) +
  labs(title = "Trust in Institutions by Migration Generation and Discrimination",
       x = "Discrimination Experience", y = "Mean Trust Index") +
  theme_minimal()

```
