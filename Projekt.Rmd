---
title: "Immigration Project"
output: html_document
date: "2025-10-06"
---


```{r}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)   
```

## Data

```{r}
# Load ESS data
dat <- read_csv("ESS7e02_3.csv")
r_vdem <- read_csv("relevant_vdem.csv")

# Select and recode relevant variables
dat2 <- dat %>%
  select(cntbrthc, fbrncntb, mbrncntb, cntry, brncntr,
         trstlgl, trstplc, trstplt, trstprl, trstprt,
         dscrgrp, hinctnta, gndr, eduyrs, agea, yrbrn) %>%
  mutate(
    migrant_gen = case_when(
      brncntr == 2 ~ "First generation", 
      brncntr == 1 & (fbrncntb != cntbrthc | mbrncntb != cntbrthc) ~ "Second generation",
      brncntr == 1 & fbrncntb == cntbrthc & mbrncntb == cntbrthc ~ "No migration background",
      TRUE ~ NA_character_
    ),
    migrant_gen = factor(migrant_gen,
                         levels = c("No migration background",
                                    "Second generation",
                                    "First generation")),
    # Binary discrimination variable
    discrim = if_else(dscrgrp == 1, 1, 0),
    gender = if_else(gndr == 1, "Male", "Female")
  )
```
   
```{r}
# Recoding variables, getting rid of missing values and looking at outliers
# fyi cntry has no missings hence it was not recoded

# Recode variables with 66 missing value, 77 refusal, 88 don't know, 99 no answer
dat2$cntbrthc[dat2$cntbrthc %in% c(66, 77, 88, 99)] <- NA 
dat2$fbrncntb[dat2$fbrncntb %in% c(66, 77, 88, 99)] <- NA # gibt noch 65	Alien's passport
dat2$mbrncntb[dat2$mbrncntb %in% c(66, 77, 88, 99)] <- NA # ebd.
dat2$cntbrthc[dat2$cntbrthc %in% c(66, 77, 88, 99)] <- NA

# Recode variables: 77 refusal, 88 don't know, 99 no answer
dat2$trstlgl[dat2$trstlgl %in% c(77, 88, 99)] <- NA
dat2$trstplc[dat2$trstplc %in% c(77, 88, 99)] <- NA
dat2$trstplt[dat2$trstplt %in% c(77, 88, 99)] <- NA
dat2$trstprl[dat2$trstprl %in% c(77, 88, 99)] <- NA
dat2$trstprt[dat2$trstprt %in% c(77, 88, 99)] <- NA
dat2$hinctnta[dat2$hinctnta %in% c(77, 88, 99)] <- NA
dat2$eduyrs[dat2$eduyrs %in% c(77, 88, 99)] <-  NA
dat2$yrbrn[dat$yrbrn %in% c(7777, 8888, 9999)] <- NA

# Recode variables: 7 refusal, 8 don't know, 9 no answer
dat2$brncntr[dat2$yrbrn %in% c(7, 8, 9)] <- NA
dat2$dscrgrp[dat2$dscrgrp %in% c(7, 8, 9)] <- NA
dat2$gndr[dat2$gndr %in% c(9)] <- NA
dat2$agea[dat2$agea %in% c(999)] <- NA

# Outlier for variable eduyrs, yrbrn and agea
table(dat2$eduyrs)
median(dat2$eduyrs, na.rm = TRUE) # 12
mean(dat2$eduyrs, na.rm = TRUE) # 12.9 
mean(dat2$yrbrn, na.rm = TRUE) # 1965
table(dat2$yrbrn, useNA = 'always') # <- Gibt 24 Fälle vor 1920 
table(dat2$agea)
median(dat2$agea, na.rm = TRUE) # 49
mean(dat2$agea, na.rm = TRUE) # 49.28 

# Recoding Country of birth
dat2$cntbrthc2 <- dat2$cntbrthc
class(dat2$cntbrthc2) #character
class(dat2$cntbrthc2)
dat2 <- dat2 %>% 
  mutate(
    cntbrthc2 = case_when(cntbrthc2 == "01" ~ "DDR",
                          cntbrthc2 == "02" ~ "USSR",
                          cntbrthc2 == "03" ~ "Czechoslovakia",
                          cntbrthc2 == "04" ~ "Yugoslavia",
                          cntbrthc2 == "05" ~ "East Timor",
                          cntbrthc2 == "06" ~ "Serbia and Montenegro",
                          cntbrthc2 == "65" ~ "Alien's passport",  # sans papier
                            TRUE ~ as.character(cntbrthc2))) 

# Check if recoding the variables worked
table(dat2$fbrncntb, useNA = 'always')
table(dat2$mbrncntb, useNA = 'always')
table(dat2$trstlgl, useNA = 'always')
table(dat2$trstplc, useNA = 'always')
table(dat2$trstplt, useNA = 'always')
table(dat2$trstprl, useNA = 'always')
table(dat2$trstprt, useNA = 'always')
table(dat2$hinctnta, useNA = 'always')
table(dat2$eduyrs, useNA = 'always')
table(dat2$yrbrn, useNA = 'always')
table(dat2$dscrgrp, useNA = 'always')
table(dat2$gndr, useNA = 'always')
table(dat2$agea, useNA = 'always')
table(dat2$cntbrthc2, useNA = 'always')

```
 
```{r}   
# Creating two trust indexes :: political institutional trust and non-political institutional trust

# political institutional trust index (mean of trust items)
dat2 <- dat2 %>%
  mutate(political_trust_index = round(rowMeans(select(., "trstplt", "trstprl", "trstprt"), na.rm = TRUE)))
dat2$political_trust_index[dat2$political_trust_index == "NaN"] <- NA
table(dat2$political_trust_index, useNA = 'always')

# non political institutional trust index (mean of trust items)
dat2 <- dat2 %>%
  mutate(non_political_trust_index = round(rowMeans(select(., "trstlgl", "trstplc"), na.rm = TRUE)))
dat2$non_political_trust_index[dat2$non_political_trust_index == "NaN"] <- NA
table(dat2$non_political_trust_index, useNA = 'always')

# distribution check
summary(dat2$political_trust_index) # median 4, mean 3.875, neutral, wenn überhaupt dann leicht rechtssteil/ linksschief
summary(dat2$non_political_trust_index) # median 6, mean 5.796, ebd.

# frame of reference V-Dem-Index Rule of Law v2x_rule
table(r_vdem$v2x_rule)

# DACH region
dat2 <- dat2 %>% 
  mutate(dach = ifelse(cntry %in% c("CH", "DE", "AT"),
    cntry,
    "other"
  ))
table(dat2$dach)

```

## Descriptive Statistic

```{r}
# total number of migrants for DACH :: bei DE und other noch eine vierte Kategorie "NA"?
dat2 %>% 
  group_by(dach) %>% 
  count(migrant_gen, na.rm = TRUE)

# total number of migrants first & second gen for DACH
dat2 %>% 
  group_by(dach) %>% 
  filter(migrant_gen %in% c("First generation", "Second generation")) %>% 
  count(migrant_gen)

# total number of migrants & second gen for DACH überarbeitet
dat2 %>% 
  filter(
    dach %in% c("AT","CH","DE"),  
    !is.na(migrant_gen)          
  ) %>% 
  count(dach, migrant_gen)

# total number of migrants for DACH plot
plot_dach_mg <- dat2 %>% 
  filter(
    dach %in% c("AT","CH","DE"),  
    !is.na(migrant_gen)          
  ) %>% 
  count(dach, migrant_gen) %>% 
  ggplot(aes(x = dach, y = n, fill = migrant_gen)) +
  geom_col(position = "dodge") +
  labs(
    x = "Country according to DACH regions",
    y = "Absolute Numbers",
    fill = "Migrant generation", caption = "Plot 1.1, based on ESS-Data") +
  theme(plot.caption = element_text(hjust = -0.1, size = 5))
plot_dach_mg

ggsave(filename = "plot_dach_mg.pdf", plot=plot_dach_mg, height = 10, width = 20, units = "cm", dpi = 600)

# number first generation for DACH :: AT 211, CH 393, DE 299, other 3633
dat2 %>% 
  group_by(dach) %>% 
  filter(migrant_gen %in% c("First generation")) %>% 
  count(migrant_gen)

# number second generation for DACH :: AT 163, CH 237, DE 268, other 3247
dat2 %>% 
  group_by(dach) %>% 
  filter(migrant_gen %in% c("Second generation")) %>% 
  count(migrant_gen)

# distribution of countries of origin in DACH
herkunft_dach <- dat2 %>% 
  filter(dach %in% c("AT", "CH", "DE"), migrant_gen == "First generation", !is.na(cntbrthc2)) %>% 
  count(cntbrthc2, sort = TRUE, name = "n") %>% 
  mutate(pct = n / sum(n))
herkunft_dach

plot_herkunft_dach <- dat2 %>% 
  filter(dach %in% c("AT", "CH", "DE"), !is.na(cntbrthc2)) %>% 
  count(cntbrthc2, sort = TRUE, name = "n") %>% 
  slice_head(n = 5) %>%
  mutate(pct = n / sum(n)) %>% 
  ggplot(aes(x = cntbrthc2, y = n, fill = cntbrthc2)) +
  geom_col(position = "dodge", fill = "steelblue") +
  labs(
    x = "Country of origin",
    y = "Percentage Numbers",
    caption = "Plot 1.2, based on ESS-Data") +
  theme(plot.caption = element_text(hjust = -0.1, size = 5))
plot_herkunft_dach

ggsave(filename = "plot_herkunft_dach.pdf", plot=plot_herkunft_dach, height = 10, width = 20, units = "cm", dpi = 600)

# distribution of countries of origin in AT :: BA: Bosnia and Herzegovina, RS: Serbia, PL: Poland, TR: Turkey, HR: Croatia
herkunft_dach_at <- dat2 %>% 
  filter(dach %in% c("AT"), migrant_gen == "First generation", !is.na(cntbrthc2)) %>% 
  count(cntbrthc2, sort = TRUE, name = "n") %>% 
  mutate(pct = n / sum(n))
head(herkunft_dach_at)
  
# distribution of countries of origin in CH :: XK: Kosovo
herkunft_dach_ch <- dat2 %>% 
  filter(dach %in% c("CH"), migrant_gen == "First generation", !is.na(cntbrthc2)) %>% 
  count(cntbrthc2, sort = TRUE, name = "n") %>% 
  mutate(pct = n / sum(n))
head(herkunft_dach_ch)

# distribution of countries of origin in DE :: RU:Russian Federation, KZ: Kazakhstan, RO: Romania, CZ: Czechia
herkunft_dach_de <- dat2 %>% 
  filter(dach %in% c("DE"), migrant_gen == "First generation", !is.na(cntbrthc2)) %>% 
  count(cntbrthc2, sort = TRUE, name = "n") %>% 
  mutate(pct = n / sum(n))
head(herkunft_dach_de)

# average trust values pol. & non-pol. depending on migration generation 
dat2 %>%
  group_by(migrant_gen) %>%
  summarise(
    mean_political_trust = mean(political_trust_index, na.rm = TRUE),
    mean_nonpolitical_trust = mean(non_political_trust_index, na.rm = TRUE),
    n = n()
  )

# Rule of Law in countries with highest number of migrants :: kommt noch


```

## H1 Political
```{r}
# Political trust
h1_political <- lm(political_trust_index ~ migrant_gen + agea + eduyrs + hinctnta + gender,
                   data = dat2)
summary(h1_political)
```
A linear regression model was estimated to examine how migration background, age, education, income, and gender are associated with political trust. The results show several significant relationships between these predictors and individuals’ political trust levels.

Both migration generation variables are significant. First-generation migrants report higher political trust compared to natives, while second-generation migrants display slightly lower political trust levels. Among the control variables, age, education, income, and gender are all positively associated with political trust. This suggests that older individuals, those with more years of education, higher household income, and men tend to express somewhat greater confidence in political institutions.

The model explains a modest share of the variance in political trust (adjusted R² = 0.041), but the highly significant F-statistic indicates that the included variables together contribute meaningfully to explaining differences in trust levels. Overall, these findings support the idea that both migration background and socioeconomic characteristics play an important role in shaping political trust.

# H1 Non-political
```{r}
# Non-political trust
h1_nonpolitical <- lm(non_political_trust_index ~ migrant_gen + agea + eduyrs + hinctnta + gender,
                      data = dat2)
summary(h1_nonpolitical)
```
A linear regression model was estimated to explore how migration background, age, education, income, and gender are associated with non-political trust. The results indicate several significant relationships between these predictors and respondents’ levels of trust in non-political institutions and people.

First-generation migrants report significantly higher non-political trust compared to natives, while second-generation migrants show significantly lower trust. This pattern mirrors the political trust results, suggesting that the first generation may retain relatively higher social trust despite being foreign-born, whereas second-generation individuals appear somewhat less trusting. Age, education, and income all have small but positive effects on non-political trust, meaning that older, more educated, and higher-income respondents tend to express greater interpersonal trust. Additionally, men report slightly higher levels of non-political trust than women.

Although the model explains a modest proportion of variance (adjusted R² = 0.034), the results confirm that both migration background and socioeconomic factors are systematically linked to levels of non-political trust.

## The trust gap between first- and second-generation immigrants varies systematically by region of origin, with the largest differences among immigrants from countries with weaker institutional performance.


## Adding democratic index
```{r}
#need to filter without country of birth? quite large number NAs
country_lookup <- readr::read_csv("country_lookup.csv")
country_lookup <- country_lookup %>% filter(cntbrthc_long != "Namibia")
#join with long country
dat2 <- dat2 %>%
  left_join(country_lookup, by = "cntbrthc")
# Standardize country names to match V-Dem dataset
dat2 <- dat2 %>%
  mutate(cntbrthc_long_standardized = case_when(
    cntbrthc_long == "Russian Federation" ~ "Russia",
    cntbrthc_long == "Syrian Arab Republic" ~ "Syria",
    cntbrthc_long == "Viet Nam" ~ "Vietnam",
    cntbrthc_long == "Iran, Islamic Republic of" ~ "Iran",
    cntbrthc_long == "Korea, Republic of" ~ "South Korea",
    cntbrthc_long == "Korea, Democratic People's Republic of" ~ "North Korea",
    cntbrthc_long == "Tanzania, United Republic of" ~ "Tanzania",
    cntbrthc_long == "Congo, Democratic Republic of the" ~ "Democratic Republic of the Congo",
    cntbrthc_long == "Congo" ~ "Republic of the Congo",
    cntbrthc_long == "Lao People's Democratic Republic" ~ "Laos",
    cntbrthc_long == "Venezuela, Bolivarian Republic of" ~ "Venezuela",
    cntbrthc_long == "Bolivia, Plurinational State of" ~ "Bolivia",
    cntbrthc_long == "Macedonia, the former Yugoslav Republic of" ~ "North Macedonia",
    cntbrthc_long == "Czechia" ~ "Czechia",
    cntbrthc_long == "Czech Republic" ~ "Czechia",
    TRUE ~ cntbrthc_long  # Keep original name if no match
  ))
# Filter r_vdem to only include the most recent year for each country
colnames(r_vdem)[1] <- "country_name"
r_vdem_recent <- r_vdem %>%
  group_by(country_name) %>%
  filter(year == max(year)) %>%
  ungroup()

#join with r_vdem using standardized country names and most recent data
dat2 <- dat2 %>% 
  left_join(r_vdem_recent, by = c("cntbrthc_long_standardized" = "country_name"))

# Check which countries still don't match after standardization
dat_wrong_cntbrthc_long <- dat2 %>% 
  filter(!is.na(cntbrthc_long) & is.na(year)) %>%
  select(cntbrthc_long, cntbrthc_long_standardized) %>%
  distinct()

# Display countries that still don't match (if any)
if(nrow(dat_wrong_cntbrthc_long) > 0) {
  print("Countries still not matching with V-Dem:")
  print(dat_wrong_cntbrthc_long)
}


```
H2 Political Trust

A linear regression model was estimated to examine whether the relationship between migration background and political trust varies depending on the rule of law in migrants' countries of origin. The model included an interaction term between migration generation and the V-Dem rule of law index, while controlling for age, education, and income.

The results show that first-generation migrants do not differ significantly from natives in their political trust levels (β = 1.075, p = 0.645). The rule of law in the country of origin shows a marginally significant positive effect (β = 0.249, p = 0.068), suggesting that migrants from countries with stronger institutional quality tend to have slightly higher political trust. However, the interaction term between first-generation status and rule of law could not be estimated due to singularities in the model, which indicates multicollinearity issues—likely because the rule of law variable doesn't vary enough within the first-generation migrant group or overlaps too much with other predictors.

Among the control variables, age has a significant negative effect on political trust, meaning older respondents tend to trust political institutions less. Education shows no significant relationship with political trust in this model, while income has a marginally significant positive effect (β = 0.031, p = 0.059), suggesting that higher earners express somewhat greater trust.

Overall, the model explains very little of the variance in political trust (adjusted R² = 0.009), and the lack of a functioning interaction term makes it difficult to draw clear conclusions about whether the trust gap varies by country of origin's institutional quality. The findings are inconclusive regarding the hypothesis that migrants from countries with weaker rule of law show different trust patterns.

## H2 Political

```{r}

# Political trust
h2_political <- lm(political_trust_index ~ migrant_gen * v2x_rule + agea + eduyrs + hinctnta, data = dat2)
summary(h2_political)


```

## H2 Non-political

```{r}
# Non-political trust
h2_nonpolitical <- lm(non_political_trust_index ~ migrant_gen * v2x_rule + agea + eduyrs + hinctnta,
                      data = dat2)
summary(h2_nonpolitical)

```


H2 Non-Political Trust

A similar regression model was estimated for non-political trust, examining how migration background and country of origin's rule of law relate to trust in non-political institutions and people, while controlling for age, education, and income.

The results show that first-generation migrants do not differ significantly from natives in non-political trust (β = -2.213, p = 0.350). However, the rule of law in the country of origin has a significant positive effect (β = 0.408, p = 0.003), indicating that migrants from countries with stronger institutional quality tend to have higher non-political trust. As with the political trust model, the interaction term could not be estimated due to singularities, preventing us from testing whether the relationship between migration status and trust varies systematically by rule of law.

Among the control variables, age is negatively associated with non-political trust, meaning younger respondents express higher trust. Education shows no significant effect, while income has a significant positive relationship (β = 0.045, p = 0.006)—higher earners report greater non-political trust.

The model explains a small but slightly larger portion of variance compared to the political trust model (adjusted R² = 0.014). The findings suggest that the institutional quality of migrants' countries of origin does matter for non-political trust, but the model's technical limitations prevent a full test of the hypothesis that trust gaps vary by region of origin.




## H3: The negative association between experiences of discrimination and institutional trust differs across different immigrant groups.

## H3 Political

```{r}

# Political trust
h3_political <- lm(political_trust_index ~ migrant_gen * discrim + agea + eduyrs + hinctnta,
                   data = dat2)
summary(h3_political)
```

A linear regression model was estimated to examine the relationship between political trust and respondents’ migrant background, experiences of discrimination, and several control variables (age, education, and income). The model included an interaction term between migration generation and perceived discrimination to explore whether the effect of discrimination on political trust differs across groups.

The results show that, on average, first-generation migrants reported significantly higher political trust compared to natives, while second-generation migrants did not differ significantly. Experiencing discrimination was associated with a significant decrease in political trust. The interaction between being a second-generation migrant and discrimination was positive and significant, suggesting that the negative effect of discrimination on trust is somewhat weaker among second-generation migrants compared to natives. Age had a small negative effect on political trust, and higher income was associated with slightly higher levels of trust. Education was not a significant predictor.

Although the model explains a modest portion of the variation in political trust (adjusted R² = 0.018), the results indicate that both migration background and perceived discrimination play a role in shaping individuals’ trust in political institutions.

## H3 Non-political

```{r}
# Non-political trust
h3_nonpolitical <- lm(non_political_trust_index ~ migrant_gen * discrim + agea + eduyrs + hinctnta,
                      data = dat2)
summary(h3_nonpolitical)

```

A second linear regression model was estimated to assess how migrant background and perceived discrimination relate to non-political trust, controlling for age, education, and income. Similar to the political trust model, interaction terms between migration generation and discrimination were included to test whether discrimination influences different groups differently.

The findings show that first-generation migrants report significantly higher non-political trust compared to natives, while the difference for second-generation migrants is not statistically significant. Perceived discrimination is strongly and negatively associated with non-political trust, indicating that those who experience discrimination tend to have lower trust in non-political institutions and people. The interaction effects between migration generation and discrimination were not significant, suggesting that the negative impact of discrimination on non-political trust is consistent across groups. Among the control variables, age, education, and income all have small but significant positive effects, meaning that older, more educated, and higher-income individuals tend to express slightly higher levels of non-political trust.

Overall, while the model explains only a small proportion of the variance in non-political trust (adjusted R² = 0.010), it indicates that discrimination plays an important role in shaping interpersonal and social trust, regardless of migration background.


## Visualization
## Trust by Migration Generation
```{r}
dat2_long <- dat2 %>%
  pivot_longer(cols = c(political_trust_index, non_political_trust_index),
               names_to = "trust_type",
               values_to = "trust_value") %>%
  mutate(trust_type = recode(trust_type,
                             political_trust_index = "Political Trust",
                             non_political_trust_index = "Non-Political Trust"))

ggplot(dat2_long, aes(x = migrant_gen, y = trust_value, fill = trust_type)) +
  geom_boxplot() +
  labs(title = "Trust in Institutions by Migration Generation",
       x = "Migration Generation", y = "Trust Index (0–10)") +
  theme_minimal()

```

## Trust Gap by Region of Origin
```{r}
dat2_long %>%
  group_by(migrant_gen, region_origin, trust_type) %>%
  summarise(mean_trust = mean(trust_value, na.rm = TRUE)) %>%
  ggplot(aes(x = migrant_gen, y = mean_trust, fill = region_origin)) +
  geom_col(position = "dodge") +
  facet_wrap(~ trust_type) +
  labs(title = "Trust in Institutions by Migration Generation and Region of Origin",
       x = "Migration Generation", y = "Mean Trust Index") +
  theme_minimal()

```

## Discrimination and Trust

```{r}
dat2_long %>%
  group_by(migrant_gen, discrim, trust_type) %>%
  summarise(mean_trust = mean(trust_value, na.rm = TRUE)) %>%
  ggplot(aes(x = factor(discrim, labels = c("No Discrimination", "Discriminated")),
             y = mean_trust, fill = migrant_gen)) +
  geom_col(position = "dodge") +
  facet_wrap(~ trust_type) +
  labs(title = "Trust in Institutions by Migration Generation and Discrimination",
       x = "Discrimination Experience", y = "Mean Trust Index") +
  theme_minimal()

```





